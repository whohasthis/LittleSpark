      (
      SELECT DISTINCT ai.manuf_serial_no, ai.contract_serial, ai.machine_type, ai.model, ai.mes, ai.manufacturer_name, coalesce(vi.asset_tag,'') as asset_tag, ai.asset_description, coalesce(aici.configuration_id,'') as configuration_id, coalesce(aici.cust_asset_status,'') as cust_asset_status, coalesce(vi.comments,'') as comments, coalesce( case when ai.product_type='I' and ai.machine_type='DELQ' then 'Docking Station' when ai.product_type='Q' and ai.machine_type='XHWD' then 'MiniDock' when ai.product_type='U' and ai.machine_type='HPKG' then 'Docking Station' else null end, case ai.product_type when 'Q' then 'PC' when 'R' then 'Laptop' else null end, case substr(ai.machine_type,1,3) when '999' then '''A'' Charge' else null end, case when ai.machine_type in ('9OT9','XOT9') then '''A'' Charge' when ai.machine_type = '2817' then 'CMOS Processors' else null end ) as product_type, ai.last_mod_date, coalesce(vi.mfg_part_no,'') as mfg_part_no, ai.contract_supp_no, (select field_text from ebcc.text_reference where field_name='LEASE_STATUS' and country_code = '897' and field_value=(ai.lease_status)) as lease_status, ai.Type_of_financing, ai.rate_k, ai.DOWN_PAY_AMOUNT, ai.DOWN_PAY_AMT_CUR, ai.amount_financed, ai.amt_financed_cur, pi.periodic_payment, pi.currency, (select field_text from ebcc.text_reference where field_name='PAYMENT_FREQUENCY' and country_code = '897' and field_value=(pi.payment_frequency)) as payment_frequency, ai.TAX_FINANCED_IND, ai.TAX_AMOUNT, ai.TAX_AMT_CUR, CHAR(ai.lease_accept_date, USA) as lease_accept_date, CHAR(ai.lease_start_date, USA) as lease_start_date, CHAR(ai.lease_exp_date, USA) as lease_exp_date, coalesce(CHAR(ai.INACTIVE_DATE, USA), '') as INACTIVE_DATE, ai.lease_term, coalesce(aici.ACCT_LEASE_TYP,'') as ACCT_LEASE_TYP, ai.cust_ref_1, ai.STEP_INDICATOR, (select field_text from ebcc.text_reference where field_name='PAYMENT_ADV_ARR' and country_code = '897' and field_value=(ai.pay_advarr)) as PAY_ADVARR, coalesce(mci.system_name,'') as system_name, coalesce(mci.system_number,'') as system_number, coalesce(mci.software_version,'') as software_version, coalesce(com.comments_finance,'') as comments_finance, coalesce(mci.inventory_auditor,'') as inventory_auditor, coalesce(vi.invoice_number,'') as invoice_number, coalesce(CHAR(vi.invoice_date, USA),'') as invoice_date, coalesce(vi.vendor_name_tpid,'') as vendor_name_tpid, coalesce(vi.vend_part_reference,'') as vend_part_reference, coalesce(vi.vendor_purchase_order,'') as vendor_purchase_order, coalesce(vi.part_desc,'') as part_desc, cp.field_value, coalesce(char(vi.total_amount_due),'') as total_amount_due, coalesce(coalesce(char(ret.receive_date, USA), char(ai.return_date, USA)),'') as receipt_date, coalesce(vi.ship_addr1 || ' ' || vi.ship_addr2,'') as ship_addr, coalesce(vi.ship_city,'') as ship_city, coalesce(vi.ship_state,'') as ship_state, coalesce(vi.ship_zip,'') as ship_zip, coalesce(vi.tracking_and_carrier,'') as tracking_and_carrier, coalesce(char(vi.serial_ctr),'') as serial_ctr, custinst.ibm_ar_branch, ai.inst_cust_no, ai.bill_cust_no, custinv.customer_name, custinv.address1, custinv.address2, custinv.city_post_town, custinv.state_prov_county, substr(custinv.ADDRESS3, 19, 10) as postal_code, custinv.address4 as department, custinv.address5 as division, custinv.address6 as country, ret.Bill_Of_Lading as Ship_To_Tracking_Number, ret.Carrier_Name as Ship_To_Carrier, ret.Receive_Serial_No as Received_Serial_Number, ret.Receive_Mfg_Serial as Received_Mfg_Serial, (select field_text from ebcc.text_reference where field_name='LEASE_SUB_STATUS' and country_code = '897' and field_value=ai.Lease_Sub_Status) as Lease_Sub_Status, null as Summary_Supplement_Number, ai.Cust_Ref_2 as CUST_REF2, (case when ai.machine_type in ('9991', '999G', '999L', '999C', '9993', '9994') then 'Parent Serial Number' when ai.machine_type in ('9TX8', 'XOT9', '999E', '9OT9') then 'Unique Serial Number' else null end) as Machine_Type_Flag FROM ebcc.asset_item ai LEFT OUTER JOIN ebcc.a_item_cust_input aici ON (ai.country_code = aici.country_code AND ai.contract_uniq_id = aici.contract_uniq_id) LEFT OUTER JOIN ebcc.more_cust_input mci ON (ai.country_code = mci.country_code AND ai.contract_uniq_id = mci.contract_uniq_id) LEFT OUTER JOIN ebcc.user_comments com ON (ai.country_code = com.country_code AND ai.contract_uniq_id = com.contract_uniq_id) LEFT OUTER JOIN ebcc.customer custinst ON (ai.inst_country_code = custinst.country_code AND ai.inst_le_no = custinst.legal_entity_no AND ai.inst_company = custinst.company_number AND ai.inst_cust_no = custinst.customer_number and custinst.customer_type='1') LEFT OUTER JOIN ebcc.customer custinv ON (ai.bill_to_country = custinv.country_code AND ai.bill_le_no = custinv.legal_entity_no AND ai.bill_to_company = custinv.company_number AND ai.bill_cust_no = custinv.customer_number and custinv.customer_type='2') LEFT OUTER JOIN ebcc.payment_information pi ON (ai.country_code = pi.country_code AND ai.contract_uniq_id = pi.contract_uniq_id AND ai.contract_supp_no = pi.contract_supp_no) LEFT OUTER JOIN ebcc.vendor_invoice vi ON (ai.country_code = vi.country_code AND ai.contract_uniq_id = vi.contract_uniq_id) LEFT OUTER JOIN ebcc.returns ret ON (ai.country_code = ret.country_code AND ai.contract_uniq_id = ret.contract_uniq_id) LEFT OUTER JOIN ebcc.country_parms cp ON (FIELD_NAME='LESSOR'  AND ai.country_code = cp.country_code) LEFT OUTER JOIN ebcc.invoice_item ii ON (ai.country_code = ii.country_code AND ai.contract_uniq_id = ii.contract_uniq_id) WHERE ai.country_code = '897' AND ai.lease_status IN ('1', '2') AND ai.inst_le_no = '057980500' AND ai.INST_CUST_NO NOT IN ('8859340','6545156','6548288','6696641','7229426','9041883','7240854','7252146','6898535') AND ai.machine_type NOT IN ('1812','1814','2145') 
      AND rtrim(ai.machine_type)||'-'||rtrim(ai.contract_serial) in ('DELD-CHC8282','DELD-CHPX182','DELD-CHP8282','DELD-CHQ9282','DELD-CHSX182','DELD-C2P0S52','DELD-C2V4S52','DELD-C2X1S52','DELD-DYV5182','DELD-DYZ2182','DELD-FFGLW52','DELD-FYFW082','DELD-FYJM082','DELD-FYKS082','DELD-FY1R082','DELD-FY1W082','DELD-FY9S082','DELD-F189D42','DELD-F4CMS52','DELD-F4FCS52','DELD-F4GBS52','DELD-F4JJS52','DELD-F4JNS52','DELD-F47DS52','DELD-F49BS52','DELD-F49JS52','DELD-GGV6382','DELD-GGX6382','DELD-GGY9382','DELD-GKS4382','DELD-GKV8382','DELD-GK08382','DELD-GK36382','DELD-GPW4382','DELD-GP85382','DELD-G5V0182','DELD-G5XX082','DELD-G53Z082','DELD-G56Y082','DELD-H4ZD082','DELD-H7YMV52','DELD-H7ZCV52','DELD-H8BLV52','DELD-H81HV52','DELD-H81MV52','DELD-H82HV52','DELD-H82RV52','DELD-H82SV52','DELD-H83KV52','DELD-H83RV52','DELD-H83SV52','DELD-H83TV52','DELD-H83VV52','DELD-H84FV52','DELD-H84PV52','DELD-H84VV52','DELD-H85DV52','DELD-H85HV52','DELD-H85JV52','DELD-H85VV52','DELD-H86MV52','DELD-H86NV52','DELD-H86WV52','DELD-H87KV52','DELD-H87MV52','DELD-H87SV52','DELD-H87VV52','DELD-H88PV52','DELD-H88QV52','DELD-H88SV52','DELD-H89GV52','DELD-H89PV52','DELD-JHDNW52','DELD-JHH8W52','DELD-JH8XW52','DELD-JV3FR32','DELD-JV3ST52','DELD-JV3WT52','DELD-JV48T52','DELD-JV5RT52','DELD-JV63T52','DELD-JV7DT52','DELD-JV82T52','DELD-JV87V52','DELD-JXN9C42','DELD-1CCW182','DELD-1CH7282','DELD-1CJC282','DELD-1CMX182','DELD-1CM8282','DELD-1CR7282','DELD-1D27282','DELD-1FWG082','DELD-1GLD082','DELD-1PGHS52','DELD-1QLJS52','DELD-1Q1LS52','DELD-1RKMS52','DELD-1ZJ7FB2','DELD-1Z6BFB2','DELD-3BPQT52','DELD-3BPST52','DELD-3BRMT52','DELD-3BSQT52','DELD-3BTTT52','DELD-3BXST52','DELD-3B0QT52','DELD-3B0RT52','DELD-3B3NT52','DELD-3B4NT52','DELD-3WY1C42','DELD-30RPV52','DELD-311QV52','DELD-315WV52','DELD-32KYZ72','DELD-33DXZ72','DELD-336XZ72','DELD-337YZ72','DELD-38H9282','DELD-38KY182','DELD-38PW182','DELD-38Q8282','DELD-3868282','DELD-389B282','DELD-3896282','DELD-39WRT52','DELD-4HCGT52','DELD-4HDKT52','DELD-4HPHT52','DELD-4H6MT52','DELD-4JKKT52','DELD-4JLFT52','DELD-4JQKT52','DELD-4K5LT52','DELD-4PH6382','DELD-4THXV52','DELD-4TSZV52','DELD-4VCYV52','DELD-4VLYV52','DELD-4VXWV52','DELD-4WQXV52','DELD-4WYYV52','DELD-4W1ZV52','DELD-4W5YV52','DELD-4W8YV52','DELD-4XHXV52','DELD-4XPZV52','DELD-4XWWV52','DELD-4XWXV52','DELD-4XYXV52','DELD-4XZYV52','DELD-4X8ZV52','DELD-4YHZV52','DELD-4YPXV52','DELD-4Y4ZV52','DELD-4ZWYV52','DELD-4ZXXV52','DELD-4Z5ZV52','DELD-5NW3R52','DELD-5NW4R52','DELD-5PXFF42','DELD-5Q8HF42','DELD-5TP8X52','DELD-5TP9X52','DELD-5TS7X52','DELD-5TX7X52','DELD-5VH2X52','DELD-5VJ9X52','DELD-5V09X52','DELD-50BXV52','DELD-508XV52','DELD-7VWDR52','DELD-7VZBR52','DELD-7W6DR52','DELD-7W8BR52','DELD-7YJBR52','DELD-7ZRBR52','DELD-8CGC282','DELD-8CHC282','DELD-8CLW182','DELD-8CPC282','DELD-8CRW182','DELD-8CX8282','DELD-8D1C282','DELD-8LDXS52','DELD-8LHRS52','DELD-8LJPS52','DELD-8L1WS52','DELD-81BBR52','DELD-81FBR52','DELD-815FR52','DELD-817DR52','DELD-82PDR52','DELD-82SBR52','DELD-84NBR52','DELD-84Q2V52','DELD-84Q9V52','DELD-84R2V52','DELD-8504V52','DELD-8536V52','DELN-BBGQSC2','DELN-BCMQSC2','DELN-BCVNLC2','DELN-BF5SN72','DELN-BLJJLC2','DELN-BLL7L72','DELN-BPCSN72','DELN-BPLTMC2','DELN-BQT23G2','DELN-BQWLK72','DELN-BWLVTF2','DELN-BZJ7KC2','DELN-B2JQLC2','DELN-B4HVN72','DELN-B45SN72','DELN-B53TN72','DELN-B6X1CG2','DELN-B74Y2H2','DELN-B9K6PC2','DELN-B9LPLC2','DELN-CBVNQF2','DELN-CB9VN72','DELN-CCT6KC2','DELN-CDN0BG2','DELN-CF8XJC2','DELN-CGRQMC2','DELN-CG2ZN72','DELN-CJJ6PC2','DELN-CLV6QC2','DELN-CLYPMC2','DELN-CM70P72','DELN-CNDW0G2','DELN-CRQZN72','DELN-CSR7CG2','DELN-CZ34P72','DELN-C1RSN72','DELN-C3N0PC2','DELN-C3Y9KC2','DELN-C4VWJC2','DELN-C412P72','DELN-C5TRN72','DELN-C5VYNC2','DELN-C52RN72','DELN-C6J6PC2','DELN-C8TTN72','DELN-C9XZ9G2','DELN-DBGD3H2','DELN-DB1PMC2','DELN-DFT9KC2','DELN-DFVNLC2','DELN-DFZRMC2','DELN-DG0TLC2','DELN-DHTTN72','DELN-DKL0PC2','DELN-DK6PLC2','DELN-DL62PC2','DELN-DP1YN72','DELN-DQ2RJC2','DELN-DS7LQC2','DELN-DTYPMC2','DELN-DVZRN72','DELN-DV6WN72','DELN-DWZRN72','DELN-DZ2QMC2','DELN-D10SN72','DELN-D19NLC2','DELN-D2Z8PF2','DELN-D6HVN72','DELN-D9M3PC2','DELN-D99RK72','DELN-FBJXN72','DELN-FBMQSC2','DELN-FBSHK72','DELN-FFBQLC2','DELN-FFQ5PC2','DELN-FF5NJC2','DELN-FF5SN72','DELN-FHPP2G2','DELN-FHPWYF2','DELN-FJVVN72','DELN-FJ9VN72','DELN-FLQYN72','DELN-FLTTN72','DELN-FNSKLC2','DELN-FQDWN72','DELN-FRK3P72','DELN-FS8TN72','DELN-FTF23G2','DELN-FTMRN72','DELN-FT7D3H2','DELN-FV514H2','DELN-FV6YN72','DELN-FWQSN72','DELN-FW40P72','DELN-FY9YN72','DELN-FZ5SN72','DELN-F0GRN72','DELN-F3KSN72','DELN-F39C9H2','DELN-F4DMPF2','DELN-F4T0BG2','DELN-F5T6KC2','DELN-F7CSN72','DELN-F7M3PC2','DELN-F9LRLC2','DELN-F9V6QC2','DELN-GFYSN72','DELN-GGBTMC2','DELN-GHJKSC2','DELN-GHT1P72','DELN-GLK2PC2','DELN-GMNQLC2','DELN-GM4GBH2','DELN-GQ0SN72','DELN-GQ12P72','DELN-GRTLSC2','DELN-GWDXNC2','DELN-GXQZN72','DELN-GYMRN72','DELN-G1KD2G2','DELN-G1QPMC2','DELN-G5HD3H2','DELN-G8X2PC2','DELN-G8Y9KC2','DELN-G88RN72','DELN-HBGXJC2','DELN-HD70P72','DELN-HFQ0MC2','DELN-HF8YNC2','DELN-HGMRN72','DELN-HGR9KC2','DELN-HGTTN72','DELN-HK4VN72','DELN-HNJXN72','DELN-HPVKKC2','DELN-HPWNMC2','DELN-HQCBKC2','DELN-HR1FKC2','DELN-HSWZN72','DELN-HT0RMC2','DELN-HVYNQ72','DELN-HVZGRC2','DELN-HWTPMC2','DELN-HWZ6KC2','DELN-HX9ZN72','DELN-H0K7KC2','DELN-H4X2PC2','DELN-H5W94H2','DELN-H6GRN72','DELN-H8X2PC2','DELN-JCHBKC2','DELN-JCK7QC2','DELN-JDWP2G2','DELN-JGGTN72','DELN-JGS0HH2','DELN-JH4DBG2','DELN-JLQSN72','DELN-JLTLSC2','DELN-JMMXJC2','DELN-JNJ6QC2','DELN-JN6PLC2','DELN-JPMTN72','DELN-JQVBKC2','DELN-JR60BG2','DELN-JVBVN72','DELN-JV9ZN72','DELN-JW2PQF2','DELN-JYK3P72','DELN-JYNXN72','DELN-JYPPMC2','DELN-JYTVPQ2','DELN-JZ79L72','DELN-J0ZPLC2','DELN-J012P72','DELN-J186KC2','DELN-J5BTK72','DELN-J5C9FC2','DELN-J55FZF2','DELN-J7703H2','DELN-J9VNLC2','DELN-J9V6CG2','DELN-1BTLK72','DELN-1B9TN72','DELN-1CJGBH2','DELN-1DC2P72','DELN-1FKXNC2','DELN-1FWY9G2','DELN-1H4YN72','DELN-1H8HHC2','DELN-1KFWN72','DELN-1PNR8H2','DELN-1PYWN72','DELN-1QMZN72','DELN-1Q9ZN72','DELN-1RWZN72','DELN-1S3YRC2','DELN-1TNZHR2','DELN-1TS3PC2','DELN-1WYPMC2','DELN-1YWLK72','DELN-1ZGTN72','DELN-1ZMTN72','DELN-1Z6WN72','DELN-1244P72','DELN-127VMC2','DELN-14JYN72','DELN-14SWN72','DELN-142QFH2','DELN-15T6KC2','DELN-16BVN72','DELN-16MWN72','DELN-180SN72','DELN-19BQLC2','DELN-19X2PC2','DELN-2DHD3H2','DELN-2GK3PH2','DELN-2G57QN2','DELN-2HJPJC2','DELN-2M01PC2','DELN-2NV1P72','DELN-2SFRN72','DELN-2V3BKC2','DELN-2WBYN72','DELN-2YND3H2','DELN-2Y7TN72','DELN-22LZPH2','DELN-23K6PC2','DELN-26QFZF2','DELN-28K7QC2','DELN-289PMC2','DELN-29MGRC2','DELN-3BCSN72','DELN-3CPRMC2','DELN-3DQKSC2','DELN-3F3RN72','DELN-3HMTN72','DELN-3JPHSF2','DELN-3JW3BG2','DELN-3LWXN72','DELN-3M40P72','DELN-3Q29L72','DELN-3RFRN72','DELN-3RMRN72','DELN-3SRSN72','DELN-3W7WN72','DELN-3YMTN72','DELN-3ZK1XF2','DELN-3Z8VNC2','DELN-30SWN72','DELN-32KHRF2','DELN-32W6QC2','DELN-346BKC2','DELN-368TN72','DELN-37SR2G2','DELN-4BKSN72','DELN-4BX2PC2','DELN-4FGTN72','DELN-4FQHRC2','DELN-4HQSN72','DELN-4KRGPH2','DELN-4KV6QC2','DELN-4K693H2','DELN-4QL0PC2','DELN-4Q40P72','DELN-4R8VJC2','DELN-4SND3H2','DELN-4T6WN72','DELN-4VZGRC2','DELN-4V5N2G2','DELN-4V9LK72','DELN-4WMQSC2','DELN-4WYCKC2','DELN-40W1P72','DELN-417HK72','DELN-42YZN72','DELN-4444P72','DELN-45M4PC2','DELN-45NZNC2','DELN-47VRN72','DELN-4940P72','DELN-5BQYNC2','DELN-5FTRN72','DELN-5FX9FC2','DELN-5F6SN72','DELN-5GLT8H2','DELN-5HD2P72','DELN-5HRVJC2','DELN-5K3WNC2','DELN-5MHVN72','DELN-5STTN72','DELN-5S2RN72','DELN-5S31P72','DELN-5T6YN72','DELN-5VS1VF2','DELN-5XRSN72','DELN-5ZDHK72','DELN-5ZQSN72','DELN-500SN72','DELN-51SFFH2','DELN-53TGRC2','DELN-534LK72','DELN-54LPPF2','DELN-552RN72','DELN-56T0BG2','DELN-58X2PC2','DELN-6BVGK72','DELN-6HBYN72','DELN-6HJJLC2','DELN-6HV1P72','DELN-6JJ6QC2','DELN-6J01PC2','DELN-6L67QC2','DELN-6M9BKC2','DELN-6P62P72','DELN-6RNQLC2','DELN-6T0RMC2','DELN-6V0ZNC2','DELN-6WGVN72','DELN-6WK1XF2','DELN-6WX01G2','DELN-6XBGBH2','DELN-6XC2PC2','DELN-6Y6YN72','DELN-6Z0PLC2','DELN-604TN72','DELN-62QG3H2','DELN-64TRN72','DELN-67YM2H2','DELN-69KZN72','DELN-69K2PC2','DELN-693QMC2','DELN-7B0VNC2','DELN-7B001G2','DELN-7CNNPF2','DELN-7DXSN72','DELN-7G3TN72','DELN-7HZF3H2','DELN-7JCSN72','DELN-7KJ6PC2','DELN-7L6PLC2','DELN-7NTXNC2','DELN-7PFWN72','DELN-7QCS8H2','DELN-7Q3VJC2','DELN-7RRSN72','DELN-7SZRN72','DELN-7S60BG2','DELN-7WH6QC2','DELN-7WPPMC2','DELN-7XHXN72','DELN-7XRRLC2','DELN-7YTWJC2','DELN-7Y9YN72','DELN-721PMC2','DELN-723QMC2','DELN-733QMC2','DELN-737SJC2','DELN-7486KC2','DELN-75H6PC2','DELN-75L8L72','DELN-778ZTF2','DELN-79MT3H2','DELN-7926KC2','DELN-8B1HK72','DELN-8CHQMC2','DELN-8FHVN72','DELN-8FMWN72','DELN-8GDWN72','DELN-8GTTN72','DELN-8HRQMC2','DELN-8JTXN72','DELN-8KVVN72','DELN-8L26KC2','DELN-8PMTN72','DELN-8P40P72','DELN-8QDTK72','DELN-8R57KC2','DELN-8XDHK72','DELN-8XRGFH2','DELN-8Y514H2','DELN-8Y84XF2','DELN-8ZF6KC2','DELN-8012PC2','DELN-81TRN72','DELN-82GRMC2','DELN-83NVN72','DELN-83SR3H2','DELN-84V1P72','DELN-86FWMC2','DELN-86G8WF2','DELN-87NKQC2','DELN-8820L72','DELN-9BQ0L72','DELN-9C7SJC2','DELN-9F5SN72','DELN-9G31P72','DELN-9HTRMC2','DELN-9J40P72','DELN-9J95PF2','DELN-9L9LK72','DELN-9M4S3H2','DELN-9PWQ4H2','DELN-9RTTN72','DELN-9SWNMC2','DELN-9TWXN72','DELN-9T483G2','DELN-9V52P72','DELN-9X5PKC2','DELN-9YK9KC2','DELN-9YWVN72','DELN-9Y5SN72','DELN-92VWJC2','DELN-9229QF2','DELN-93GRK72','DELN-932SJC2','DELN-96YZN72','DELN-98M4PC2','DELN-99J6PC2','ZLND-MJ02YSRB','ZLND-MJ02YSZC','ZLND-MJ02YTAU','ZLND-MJ02YTGN','ZLND-MJ02YTRW','ZLND-MJ02YT3W','ZLND-MJ02YT8M','ZLND-MJ02YUJF','ZLND-MJ02YULP','ZLND-MJ02YUM2','ZLND-MJ02YUUA','ZLND-MJ02YUVE','ZLND-MJ02YU6R','ZLND-MJ02YU7F','ZLND-MJ02Y7W1','ZLND-MJ02Y8FV','ZLND-MJ02Y8HG','ZLND-MJ02Y8HJ','ZLND-MJ02Y89E','ZLND-MJ02Y9L4','ZLND-MJ02Y9R3','ZLND-MJ02Y9SF','ZLND-MJ02ZPAU','ZLND-MJ02ZQ6M','ZLND-MJ03QZKR','ZLND-MJ03QZ4F','ZLND-MJ03R1Z1','ZLND-MJ03TTGW','ZLND-MJ03TTNV','ZLND-MJ03TT4U','ZLND-MJ03TT50','ZLND-MJ030S4Q','ZLND-MJ0307M3','ZLND-MJ03075S','ZLND-MJ0309RF','ZLND-MJ0309T1','ZLND-MJ0309WH','ZLND-MJ0309YW','ZLND-MJ031LBB','ZLND-MJ031PP1','ZLND-MJ031PRK','ZLND-MJ031PXZ','ZLND-MJ031PYF','ZLND-MJ031PZF','ZLND-MJ031PZW','ZLND-MJ0310QB','ZLND-MJ043LZ2','ZLND-MJ043N11','ZLND-MJ0438RM','ZLND-PC0BHP6L','ZLND-PC0C0H0U','ZLNN-F002P72','ZLNN-MJ033LU7','ZLNN-PC0VQVRX','ZLNN-PC0VQVS8','ZLNN-PC0WFUAN','ZLNN-PC0WFUAP','ZLNN-PC0WFUB3','ZLNN-PC0WFUB4','ZLNN-PC0WFU8H','ZLNN-PC0WFU87','ZLNN-PC0WFU98','ZLNN-PC0W6H24','ZLNN-PC0W6H25','ZLNN-PC0XCP48','ZLNN-PF0Z6TBR','ZLNN-R90KEBRP','ZLNN-R90KEBR5','ZLNN-R90KEBS0','ZLNN-R90KEBT1','ZLNN-R90KEBUV','ZLNN-R90KEBU2','ZLNN-R90KSZJR','ZLNN-R90KSZLM','ZLNN-R90KSZL1','ZLNN-R90KSZL2','ZLNN-R90KSZMB','ZLNN-R90KSZMK','ZLNN-R90KSZNU','ZLNN-R90KSZN1','ZLNN-R90KSZN2','ZLNN-R90KSZPB','ZLNN-R90LAKVR','ZLNN-R90LAKWB','ZLNN-R90LAKWL','ZLNN-R90LAKWN','ZLNN-R90LAKWP','ZLNN-R90LAKW0','ZLNN-R90LAKXU','ZLNN-R90LAKX1','ZLNN-R90LAKX4','ZLNN-R90LAKX9','ZLNN-R90LAKYA','ZLNN-R90LAKYD','ZLNN-R90LAKYL','ZLNN-R90LAKYQ','ZLNN-R90LAKYS','ZLNN-R90LAKYU','ZLNN-R90LAKYZ','ZLNN-R90LAKY4','ZLNN-R90LAKY6','ZLNN-R90LAKY7','ZLNN-R90LAKZG','ZLNN-R90LAKZV','ZLNN-R90LAKZ7','ZLNN-R90LAKZ9','ZLNN-R90LAL0A','ZLNN-R90LAL0F','ZLNN-R90LAL0J','ZLNN-R90LAL0L','ZLNN-R90LAL0U','ZLNN-R90LAL0Z','ZLNN-R90LAL01','ZLNN-R90LAL08','ZLNN-R90LAL1D','ZLNN-R90LAL11','ZLNN-R90LAL12','ZLNN-R90LAL14','ZLNN-R90LWNGQ','ZLNN-R90LWNJJ','ZLNN-R90LWNJ8','ZLNN-R90LWNJ9','ZLNN-R90L1EFM','ZLNN-R90L1EGP','ZLNN-R90L1EG3','ZLNN-R90L1EHH','ZLNN-R90L1EH6','ZLNN-R90L1EJD','ZLNN-R90L1EJX','ZLNN-R90L1EJ1','ZLNN-R90L1EJ7','ZLNN-R90L1EKG','ZLNN-R90L1EKS','ZLNN-R90L1EL4','ZLNN-R90L1EL7','ZLNN-R90L1EL9','ZLNN-R90L1EMM','ZLNN-R90L1EMV','ZLNN-R90L1ENV','ZLNN-R90L1EN8','ZLNN-R90L3BAG','ZLNN-R90L3BBD','ZLNN-R90L3BBN','ZLNN-R90L3BBX','ZLNN-R90L3BB7','ZLNN-R90L3BCF','ZLNN-R90L3BCJ','ZLNN-R90L3BC1','ZLNN-R90L3BDC','ZLNN-R90L3BDJ','ZLNN-R90L3BDZ','ZLNN-R90L3BEJ','ZLNN-R90L3BEV','ZLNN-R90L3BF5','ZLNN-R90L3BG3','ZLNN-R90L3BG5')
      UNION
      SELECT DISTINCT ai.manuf_serial_no, ai.contract_serial, ai.machine_type, ai.model, ai.mes, ai.manufacturer_name, coalesce(vi.asset_tag,'') as asset_tag, ai.asset_description, coalesce(aici.configuration_id,'') as configuration_id, coalesce(aici.cust_asset_status,'') as cust_asset_status, coalesce(vi.comments,'') as comments, coalesce( case when ai.product_type='I' and ai.machine_type='DELQ' then 'Docking Station' when ai.product_type='Q' and ai.machine_type='XHWD' then 'MiniDock' when ai.product_type='U' and ai.machine_type='HPKG' then 'Docking Station' else null end, case ai.product_type when 'Q' then 'PC' when 'R' then 'Laptop' else null end, case substr(ai.machine_type,1,3) when '999' then '''A'' Charge' else null end, case when ai.machine_type in ('9OT9','XOT9') then '''A'' Charge' when ai.machine_type = '2817' then 'CMOS Processors' else null end ) as product_type, ai.last_mod_date, coalesce(vi.mfg_part_no,'') as mfg_part_no, ai.contract_supp_no, (select field_text from ebcc.text_reference where field_name='LEASE_STATUS' and country_code = '897' and field_value=(ai.lease_status)) as lease_status, ai.Type_of_financing, ai.rate_k, ai.DOWN_PAY_AMOUNT, ai.DOWN_PAY_AMT_CUR, ai.amount_financed, ai.amt_financed_cur, pi.periodic_payment, pi.currency, (select field_text from ebcc.text_reference where field_name='PAYMENT_FREQUENCY' and country_code = '897' and field_value=(pi.payment_frequency)) as payment_frequency, ai.TAX_FINANCED_IND, ai.TAX_AMOUNT, ai.TAX_AMT_CUR, CHAR(ai.lease_accept_date, USA) as lease_accept_date, CHAR(ai.lease_start_date, USA) as lease_start_date, CHAR(ai.lease_exp_date, USA) as lease_exp_date, coalesce(CHAR(ai.INACTIVE_DATE, USA), '') as INACTIVE_DATE, ai.lease_term, coalesce(aici.ACCT_LEASE_TYP,'') as ACCT_LEASE_TYP, ai.cust_ref_1, ai.STEP_INDICATOR, (select field_text from ebcc.text_reference where field_name='PAYMENT_ADV_ARR' and country_code = '897' and field_value=(ai.pay_advarr)) as PAY_ADVARR, coalesce(mci.system_name,'') as system_name, coalesce(mci.system_number,'') as system_number, coalesce(mci.software_version,'') as software_version, coalesce(com.comments_finance,'') as comments_finance, coalesce(mci.inventory_auditor,'') as inventory_auditor, coalesce(vi.invoice_number,'') as invoice_number, coalesce(CHAR(vi.invoice_date, USA),'') as invoice_date, coalesce(vi.vendor_name_tpid,'') as vendor_name_tpid, coalesce(vi.vend_part_reference,'') as vend_part_reference, coalesce(vi.vendor_purchase_order,'') as vendor_purchase_order, coalesce(vi.part_desc,'') as part_desc, cp.field_value, coalesce(char(vi.total_amount_due),'') as total_amount_due, coalesce(coalesce(char(ret.receive_date, USA), char(ai.return_date, USA)),'') as receipt_date, coalesce(vi.ship_addr1 || ' ' || vi.ship_addr2,'') as ship_addr, coalesce(vi.ship_city,'') as ship_city, coalesce(vi.ship_state,'') as ship_state, coalesce(vi.ship_zip,'') as ship_zip, coalesce(vi.tracking_and_carrier,'') as tracking_and_carrier, coalesce(char(vi.serial_ctr),'') as serial_ctr, custinst.ibm_ar_branch, ai.inst_cust_no, ai.bill_cust_no, custinv.customer_name, custinv.address1, custinv.address2, custinv.city_post_town, custinv.state_prov_county, substr(custinv.ADDRESS3, 19, 10) as postal_code, custinv.address4 as department, custinv.address5 as division, custinv.address6 as country, ret.Bill_Of_Lading as Ship_To_Tracking_Number, ret.Carrier_Name as Ship_To_Carrier, ret.Receive_Serial_No as Received_Serial_Number, ret.Receive_Mfg_Serial as Received_Mfg_Serial, (select field_text from ebcc.text_reference where field_name='LEASE_SUB_STATUS' and country_code = '897' and field_value=ai.Lease_Sub_Status) as Lease_Sub_Status, null as Summary_Supplement_Number, ai.Cust_Ref_2 as CUST_REF2, (case when ai.machine_type in ('9991', '999G', '999L', '999C', '9993', '9994') then 'Parent Serial Number' when ai.machine_type in ('9TX8', 'XOT9', '999E', '9OT9') then 'Unique Serial Number' else null end) as Machine_Type_Flag FROM ebcc.asset_item ai LEFT OUTER JOIN ebcc.a_item_cust_input aici ON (ai.country_code = aici.country_code AND ai.contract_uniq_id = aici.contract_uniq_id) LEFT OUTER JOIN ebcc.more_cust_input mci ON (ai.country_code = mci.country_code AND ai.contract_uniq_id = mci.contract_uniq_id) LEFT OUTER JOIN ebcc.user_comments com ON (ai.country_code = com.country_code AND ai.contract_uniq_id = com.contract_uniq_id) LEFT OUTER JOIN ebcc.customer custinst ON (ai.inst_country_code = custinst.country_code AND ai.inst_le_no = custinst.legal_entity_no AND ai.inst_company = custinst.company_number AND ai.inst_cust_no = custinst.customer_number and custinst.customer_type='1') LEFT OUTER JOIN ebcc.customer custinv ON (ai.bill_to_country = custinv.country_code AND ai.bill_le_no = custinv.legal_entity_no AND ai.bill_to_company = custinv.company_number AND ai.bill_cust_no = custinv.customer_number and custinv.customer_type='2') LEFT OUTER JOIN ebcc.payment_information pi ON (ai.country_code = pi.country_code AND ai.contract_uniq_id = pi.contract_uniq_id AND ai.contract_supp_no = pi.contract_supp_no) LEFT OUTER JOIN ebcc.vendor_invoice vi ON (ai.country_code = vi.country_code AND ai.contract_uniq_id = vi.contract_uniq_id) LEFT OUTER JOIN ebcc.returns ret ON (ai.country_code = ret.country_code AND ai.contract_uniq_id = ret.contract_uniq_id) LEFT OUTER JOIN ebcc.country_parms cp ON (FIELD_NAME='LESSOR'  AND ai.country_code = cp.country_code) LEFT OUTER JOIN ebcc.invoice_item ii ON (ai.country_code = ii.country_code AND ai.contract_uniq_id = ii.contract_uniq_id) WHERE ai.country_code = '897' AND ai.lease_status IN ('1', '2') AND ai.inst_le_no = '057980500' AND ai.INST_CUST_NO NOT IN ('8859340','6545156','6548288','6696641','7229426','9041883','7240854','7252146','6898535') AND ai.machine_type NOT IN ('1812','1814','2145')
      AND ai.last_mod_date >= CHAR(CURRENT DATE - 14 DAYS) || '-00.00.00.000000' AND ai.last_mod_date !='2020-02-12 15:07:51.50714'
      UNION
      SELECT DISTINCT ai.manuf_serial_no, ai.contract_serial, ai.machine_type, ai.model, ai.mes, ai.manufacturer_name, coalesce(vi.asset_tag, '') AS asset_tag, ai.asset_description, coalesce(aici.configuration_id, '') AS configuration_id, coalesce(aici.cust_asset_status, '') AS cust_asset_status, coalesce(vi.comments, '') AS comments, coalesce(CASE WHEN ai.product_type = 'I' AND ai.machine_type = 'DELQ' THEN 'Docking Station' WHEN ai.product_type = 'Q' AND ai.machine_type = 'XHWD' THEN 'MiniDock' WHEN ai.product_type = 'U' AND ai.machine_type = 'HPKG' THEN 'Docking Station' ELSE NULL END, CASE ai.product_type WHEN 'Q' THEN 'PC' WHEN 'R' THEN 'Laptop' ELSE NULL END, CASE substr(ai.machine_type, 1, 3) WHEN '999' THEN '''A'' Charge' ELSE NULL END, CASE WHEN ai.machine_type IN ( '9OT9', 'XOT9' ) THEN '''A'' Charge' WHEN ai.machine_type = '2817' THEN 'CMOS Processors' ELSE NULL END) AS product_type, ai.last_mod_date, coalesce(vi.mfg_part_no, '') AS mfg_part_no, ai.contract_supp_no, ( SELECT field_text FROM ebcc.text_reference WHERE field_name = 'LEASE_STATUS' AND country_code = '897' AND field_value = (ai.lease_status) ) AS lease_status, ai.Type_of_financing, ai.rate_k, ai.DOWN_PAY_AMOUNT, ai.DOWN_PAY_AMT_CUR, ai.amount_financed, ai.amt_financed_cur, pi.periodic_payment, pi.currency, ( SELECT field_text FROM ebcc.text_reference WHERE field_name = 'PAYMENT_FREQUENCY' AND country_code = '897' AND field_value = (pi.payment_frequency) ) AS payment_frequency, ai.TAX_FINANCED_IND, ai.TAX_AMOUNT, ai.TAX_AMT_CUR, CHAR(ai.lease_accept_date, USA) AS lease_accept_date, CHAR(ai.lease_start_date, USA) AS lease_start_date, CHAR(ai.lease_exp_date, USA) AS lease_exp_date, coalesce(CHAR(ai.INACTIVE_DATE, USA), '') AS INACTIVE_DATE, ai.lease_term, coalesce(aici.ACCT_LEASE_TYP, '') AS ACCT_LEASE_TYP, ai.cust_ref_1, ai.STEP_INDICATOR, ( SELECT field_text FROM ebcc.text_reference WHERE field_name = 'PAYMENT_ADV_ARR' AND country_code = '897' AND field_value = (ai.pay_advarr) ) AS PAY_ADVARR, coalesce(mci.system_name, '') AS system_name, coalesce(mci.system_number, '') AS system_number, coalesce(mci.software_version, '') AS software_version, coalesce(com.comments_finance, '') AS comments_finance, coalesce(mci.inventory_auditor, '') AS inventory_auditor, coalesce(vi.invoice_number, '') AS invoice_number, coalesce(CHAR(vi.invoice_date, USA), '') AS invoice_date, coalesce(vi.vendor_name_tpid, '') AS vendor_name_tpid, coalesce(vi.vend_part_reference, '') AS vend_part_reference, coalesce(vi.vendor_purchase_order, '') AS vendor_purchase_order, coalesce(vi.part_desc, '') AS part_desc, cp.field_value, coalesce(CHAR(vi.total_amount_due), '') AS total_amount_due, coalesce(coalesce(CHAR(ret.receive_date, USA), CHAR(ai.return_date, USA)), '') AS receipt_date, coalesce(vi.ship_addr1 || ' ' || vi.ship_addr2, '') AS ship_addr, coalesce(vi.ship_city, '') AS ship_city, coalesce(vi.ship_state, '') AS ship_state, coalesce(vi.ship_zip, '') AS ship_zip, coalesce(vi.tracking_and_carrier, '') AS tracking_and_carrier, coalesce(CHAR(vi.serial_ctr), '') AS serial_ctr, custinst.ibm_ar_branch, ai.inst_cust_no, ai.bill_cust_no, custinv.customer_name, custinv.address1, custinv.address2, custinv.city_post_town, custinv.state_prov_county, substr(custinv.ADDRESS3, 19, 10) AS postal_code, custinv.address4 AS department, custinv.address5 AS division, custinv.address6 AS country, ret.Bill_Of_Lading AS Ship_To_Tracking_Number, ret.Carrier_Name AS Ship_To_Carrier, ret.Receive_Serial_No AS Received_Serial_Number, ret.Receive_Mfg_Serial AS Received_Mfg_Serial, ( SELECT field_text FROM ebcc.text_reference WHERE field_name = 'LEASE_SUB_STATUS' AND country_code = '897' AND field_value = ai.Lease_Sub_Status ) AS Lease_Sub_Status, NULL AS Summary_Supplement_Number, ai.Cust_Ref_2 AS CUST_REF2, ( CASE WHEN ai.machine_type IN ( '9991', '999G', '999L', '999C', '9993', '9994' ) THEN 'Parent Serial Number' WHEN ai.machine_type IN ( '9TX8', 'XOT9', '999E', '9OT9' ) THEN 'Unique Serial Number' ELSE NULL END ) AS Machine_Type_Flag FROM ebcc.asset_item ai JOIN ebcc.RETURNS ret ON ( ai.country_code = ret.country_code AND ai.contract_uniq_id = ret.contract_uniq_id ) LEFT OUTER JOIN ebcc.a_item_cust_input aici ON ( ai.country_code = aici.country_code AND ai.contract_uniq_id = aici.contract_uniq_id ) LEFT OUTER JOIN ebcc.more_cust_input mci ON ( ai.country_code = mci.country_code AND ai.contract_uniq_id = mci.contract_uniq_id ) LEFT OUTER JOIN ebcc.user_comments com ON ( ai.country_code = com.country_code AND ai.contract_uniq_id = com.contract_uniq_id ) LEFT OUTER JOIN ebcc.customer custinst ON ( ai.inst_country_code = custinst.country_code AND ai.inst_le_no = custinst.legal_entity_no AND ai.inst_company = custinst.company_number AND ai.inst_cust_no = custinst.customer_number AND custinst.customer_type = '1' ) LEFT OUTER JOIN ebcc.customer custinv ON ( ai.bill_to_country = custinv.country_code AND ai.bill_le_no = custinv.legal_entity_no AND ai.bill_to_company = custinv.company_number AND ai.bill_cust_no = custinv.customer_number AND custinv.customer_type = '2' ) LEFT OUTER JOIN ebcc.payment_information pi ON ( ai.country_code = pi.country_code AND ai.contract_uniq_id = pi.contract_uniq_id AND ai.contract_supp_no = pi.contract_supp_no ) LEFT OUTER JOIN ebcc.vendor_invoice vi ON ( ai.country_code = vi.country_code AND ai.contract_uniq_id = vi.contract_uniq_id ) LEFT OUTER JOIN ebcc.country_parms cp ON ( FIELD_NAME = 'LESSOR' AND ai.country_code = cp.country_code ) LEFT OUTER JOIN ebcc.invoice_item ii ON ( ai.country_code = ii.country_code AND ai.contract_uniq_id = ii.contract_uniq_id ) WHERE ai.country_code = '897' AND ai.lease_status IN ( '1', '2' ) AND ai.inst_le_no = '057980500' AND ai.INST_CUST_NO NOT IN ( '8859340', '6545156', '6548288', '6696641', '7229426', '9041883', '7240854', '7252146', '6898535' ) AND ai.machine_type NOT IN ( '1812', '1814', '2145' ) AND ret.last_mod_date >= CHAR(CURRENT DATE - 14 DAYS) || '-00.00.00.000000' 
      ) ORDER BY 1, 2  WITH ur    